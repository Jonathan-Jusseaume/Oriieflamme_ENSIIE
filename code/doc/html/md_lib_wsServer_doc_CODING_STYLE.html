<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Oriieflamme: wsServer Coding Style</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Oriieflamme
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Recherche','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Recherche');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">wsServer Coding Style </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>wsServer is a simple project, and therefore I don't believe there is so much interest in it. However, as I have received a few contributions over the years, it may be interesting to write something about it.</p>
<p>(much of what is here is (heavily-)based on <a href="https://github.com/nanvix/documentation/blob/master/6-contrib/3-coding-style.md">Nanvix</a>'s and <a href="https://www.kernel.org/doc/html/v4.10/process/coding-style.html">Linux</a>'s coding style.)</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Indentation</h1>
<ul>
<li><em>Always</em> use <b>tab</b> characters for indentation.</li>
<li>Tab width: 4 characters.</li>
<li>Indent case labels in switch statements, such as: <div class="fragment"><div class="line"><span class="keywordflow">switch</span> (var)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">case</span> bar:</div>
<div class="line">        something;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> beef:</div>
<div class="line">        something</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">}</div>
</div><!-- fragment --></li>
<li>Do not put multiples statements nor multiples assignments in a single line.</li>
</ul>
<h1><a class="anchor" id="autotoc_md14"></a>
Long lines length</h1>
<ul>
<li>Even though Mr. Torvalds has <a href="https://www.theregister.com/2020/06/01/linux_5_7/">said</a> that nowadays it is ok to use large lines, I'll keep to 80 columns with five (85) of tolerance. However, use common sense here.</li>
<li>While breaking long lines, indent the next line at one level.</li>
</ul>
<h1><a class="anchor" id="autotoc_md15"></a>
Placing Braces and Spaces</h1>
<ul>
<li>Allman style: whether functions or control statements, place the braces always in the next line. Statements within the braces are indented at one level.</li>
</ul>
<p>Ex: </p><div class="fragment"><div class="line"><span class="keywordtype">void</span> foo(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span> (something)</div>
<div class="line">    {</div>
<div class="line">        bar();</div>
<div class="line">        baz();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        deadbeef();</div>
<div class="line"> </div>
<div class="line">    something_else(); <span class="comment">/* put always a blank line between a control block</span></div>
<div class="line"><span class="comment">                without braces and the next statement. */</span></div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li>If one line is enough (like function call or variable assignment), do not put braces. Keep in mind the readability: put a blank line between statements.</li>
</ul>
<h1><a class="anchor" id="autotoc_md16"></a>
Spaces</h1>
<ul>
<li>Use one space after these keywords: <code>if, switch, case, for, do, while</code>.</li>
<li>Use one space around (on each side of) most binary and ternary operators: <code>= + - &lt; &gt; * / % | &amp; ^ &lt;= &gt;= == != ? :</code>.</li>
<li>But no space after unary operators: <code>&amp; * + - ~ ! sizeof</code>.</li>
<li>No space after/before the postfix/prefix increment &amp; decrement unary operators: <code>++ --</code>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md17"></a>
Variables and Naming</h1>
<ul>
<li>Do not use mixed-cases to name your variables. Always use lower-case for variables and functions name. Underscores are acceptable to give a more descriptive name, e.g., <code>int next_frame(...)</code>.</li>
<li>Always use uppercase for macros.</li>
<li>Do not use <em>typedef</em> s unless for totally opaque objects. The reasoning is simple: it <em>hides</em> the original meaning of the variable. Is it a union, struct, an integer?.</li>
<li>(Try to) do not mix variable declaration with your code. Declare your variables at the very beginning of the scope of that variable.</li>
</ul>
<h1><a class="anchor" id="autotoc_md18"></a>
Commenting/Documenting</h1>
<ul>
<li>Use always <code>/* c89 style. */</code> in your code, even for a single line.</li>
<li>Use Doxygen syntax to document functions and structures, even for the internal API.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md20"></a>
Using clang-format</h1>
<p><code>clang-format</code> is a command-line tool, part of the LLVM project that, for a pre-defined set of rules or a given file, automatically formats source code. wsServer comes with a .clang-format file in the root directory that tries to embrace most of these rules above.</p>
<p>Please note that the .clang-format file does not fully cover everything described here and even in cases that do, it is always important to carefully evaluate the output generated by it, since sometimes it may be far from ideal, use common sense here.</p>
<p>My suggestion would be something like:</p><ul>
<li>Commit what you need to commit (<b>locally</b>).</li>
<li>Apply clang-format over the file: <code>clang-format -style=file -i src/file.c</code>.</li>
<li>Manually check changes on the file.</li>
<li>Make a commit amend if applicable.</li>
</ul>
<p>Similarly, instead of performing an amend, you can also generate a newly formatted file and then perform a diff of the original with the new one: </p><div class="fragment"><div class="line">clang-format -style=file file.c &gt; newfile.c</div>
<div class="line">diff -u file.c newfile.c &gt; diffs.patch        # see this file</div>
</div><!-- fragment --><p> Pick what you think is best. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré par&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
